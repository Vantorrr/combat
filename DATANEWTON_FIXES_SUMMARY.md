# ‚úÖ DataNewton API - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è

**–î–∞—Ç–∞:** 30.10.2024

## üéØ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ì–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã (`/v1/governmentContractsStat`)
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ 403 "–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω–æ–º—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É"  
**–†–µ—à–µ–Ω–∏–µ:** 
- ‚úÖ API –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞—Ä–∏—Ñ
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∑–∞–ø—Ä–æ—Å: —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º –û–ì–†–ù –≤–º–µ—Å—Ç–æ –ò–ù–ù
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `type=ALL`
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç: `suppliers_stat` –∏ `customers_stat`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞–±–æ—Ç–∞–µ—Ç! –ü–æ–ª—É—á–∞–µ–º –æ–±—â—É—é —Å—É–º–º—É –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è.

---

### 2. –ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ –¥–µ–ª–∞ (`/v1/arbitration-cases`)
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ 409 "–ü–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ `/v1/arbitration/batchCases`  
**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç `/v1/arbitration-cases`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `inn`, `status=OPEN`, `limit=1000`
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç: –∏—Å–ø–æ–ª—å–∑—É–µ–º `total_cases` –≤–º–µ—Å—Ç–æ `total_count`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞–±–æ—Ç–∞–µ—Ç! –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö –¥–µ–ª.

---

### 3. –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (`/v1/finance`)
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `{"available_count": 4992}` –±–µ–∑ —Å–∞–º–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–ª–æ–∂–Ω–∞—è
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `balances`, `fin_results`, `money_flow`
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –ø–∞—Ä—Å–∏–Ω–≥—É –∏–µ—Ä–∞—Ä—Ö–∏–∏

**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç. –î–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏.

---

## üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ì–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
```bash
curl "https://api.datanewton.ru/v1/governmentContractsStat?key=YOUR_KEY&ogrn=1027739020760&type=ALL"
```
**–û—Ç–≤–µ—Ç:**
```json
{
  "suppliers_stat": {
    "stat": [
      {"year": "2023", "sum": 91832372, "amount": 7},
      {"year": "2024", "sum": 38105996, "amount": 3}
    ]
  }
}
```

### –ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ –¥–µ–ª–∞
```bash
curl "https://api.datanewton.ru/v1/arbitration-cases?key=YOUR_KEY&inn=7728212268&status=OPEN&limit=1000"
```
**–û—Ç–≤–µ—Ç:**
```json
{
  "total_cases": 4,
  "data": [...]
}
```

---

## üöÄ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥

### 1. –§—É–Ω–∫—Ü–∏—è —Ç–æ—á–µ—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
**–§–∞–π–ª:** `services/google_sheets.py`

–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `update_specific_columns()` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:

```python
await sheets.update_specific_columns(
    sheet_id="YOUR_SHEET_ID", 
    inn="7728212268",
    updates={
        'Q': '4',  # –ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ –¥–µ–ª–∞
        'P': '200125434',  # –ì–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
        'R': '–Ω–µ—Ç'  # –ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ
    }
)
```

**–≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤:** –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —è—á–µ–π–∫–∏ –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ —Å—Ç—Ä–æ–∫–∏.

---

### 2. –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
**–§–∞–π–ª:** `scripts/auto_update_data.py`

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron) –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö:

```bash
# –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ –¥–µ–ª–∞ (1 —Ç–æ–∫–µ–Ω –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é)
python scripts/auto_update_data.py --sheet-id SHEET_ID --columns Q

# –û–±–Ω–æ–≤–∏—Ç—å –∞—Ä–±–∏—Ç—Ä–∞–∂ + –≥–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã + –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ
python scripts/auto_update_data.py --sheet-id SHEET_ID --columns Q P R
```

**–ü—Ä–∏–º–µ—Ä cron:** –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 9:00
```bash
0 9 * * 1 cd /path/to/CRMbot && python scripts/auto_update_data.py --sheet-id SHEET_ID --columns Q
```

---

### 3. –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
**–§–∞–π–ª:** `test_datanewton_endpoints.py`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã API:

```bash
python test_datanewton_endpoints.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:**
```
‚úì Company found: –ê–û "–§–ö "–°–ü–ê–†–¢–ê–ö-–ú–û–°–ö–í–ê"
‚úì Government contracts total: 200125434
‚úì Open arbitration cases: 4
‚úì Full company data retrieved
```

---

## üí∞ –†–∞—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤

### –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–≤–æ–Ω–∫–µ (–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):
- `/v1/counterparty` - 1 —Ç–æ–∫–µ–Ω
- `/v1/finance` - 1 —Ç–æ–∫–µ–Ω
- `/v1/governmentContractsStat` - 1 —Ç–æ–∫–µ–Ω
- `/v1/arbitration-cases` - 1 —Ç–æ–∫–µ–Ω
**–ò—Ç–æ–≥–æ:** 4 —Ç–æ–∫–µ–Ω–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞

### –ü—Ä–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ):
- –ê—Ä–±–∏—Ç—Ä–∞–∂ - 1 —Ç–æ–∫–µ–Ω
- –ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ - 1 —Ç–æ–∫–µ–Ω (—á–µ—Ä–µ–∑ counterparty)
- –ì–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã - 2 —Ç–æ–∫–µ–Ω–∞ (counterparty + governmentContractsStat)
**–ò—Ç–æ–≥–æ:** 2-4 —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–∏–º–µ—Ä –¥–ª—è 100 –∫–æ–º–ø–∞–Ω–∏–π:
- –ü–µ—Ä–≤–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: 100 √ó 4 = 400 —Ç–æ–∫–µ–Ω–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é (—Ç–æ–ª—å–∫–æ –∞—Ä–±–∏—Ç—Ä–∞–∂): 100 √ó 1 = 100 —Ç–æ–∫–µ–Ω–æ–≤/–Ω–µ–¥–µ–ª—é
- **–ó–∞ –º–µ—Å—è—Ü:** 400 + (100 √ó 4 –Ω–µ–¥–µ–ª–∏) = 800 —Ç–æ–∫–µ–Ω–æ–≤
- **–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ —Ç–∞—Ä–∏—Ñ–µ 5000:** 4200 —Ç–æ–∫–µ–Ω–æ–≤

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –°—Ç–∞—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å):
- ‚úÖ –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- ‚úÖ –ò–ù–ù, –û–ì–†–ù
- ‚úÖ –ê–¥—Ä–µ—Å
- ‚úÖ –û–ö–í–≠–î
- ‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä
- ‚úÖ –†–µ–≥–∏–æ–Ω

### –î–∏–Ω–∞–º–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ–±–Ω–æ–≤–ª—è—Ç—å —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é):
- üîÑ **–ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ –¥–µ–ª–∞** - –≤–∞–∂–Ω–æ! –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ —Å—É–¥—ã
- üîÑ –ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ - —Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è, –Ω–æ –≤–∞–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å
- üîÑ –§–∏–Ω–∞–Ω—Å—ã - –æ–±–Ω–æ–≤–ª—è—Ç—å —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª/–≥–æ–¥

### –ß–∞—Å—Ç–∏—á–Ω–æ –¥–∏–Ω–∞–º–∏—á–Ω—ã–µ (–æ–±–Ω–æ–≤–ª—è—Ç—å —Ä–µ–∂–µ):
- üîÑ –ì–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã - –æ–±–Ω–æ–≤–ª—è—Ç—å —Ä–∞–∑ –≤ –º–µ—Å—è—Ü/–∫–≤–∞—Ä—Ç–∞–ª
- üîÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ - —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ì–æ—Ç–æ–≤–æ:** API –≥–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∏ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
2. ‚è≥ **–í —Ä–∞–±–æ—Ç–µ:** –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–≤—ã—Ä—É—á–∫–∞, –∞–∫—Ç–∏–≤—ã)
3. üéØ **–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:** 
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - –î–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è —Å DataNewton –æ –±–µ–∑–ª–∏–º–∏—Ç–µ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
   - –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: –ì–æ—Å–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã](https://datanewton.ru/docs/api/governmentContractsStat)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: –ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ –¥–µ–ª–∞](https://datanewton.ru/docs/api/arbitration-cases)
- [–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤](./DATANEWTON_API_EXAMPLES.md)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron](./cron_example.txt)



